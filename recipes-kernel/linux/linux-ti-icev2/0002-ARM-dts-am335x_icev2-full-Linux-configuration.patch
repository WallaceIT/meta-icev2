From c15b554de2a230d8309526da983f69ac90ce7f70 Mon Sep 17 00:00:00 2001
From: Francesco Valla <valla.francesco@gmail.com>
Date: Fri, 29 Jul 2016 23:09:19 +0200
Subject: [PATCH 2/2] ARM: dts: am335x_icev2: full-Linux configuration

Signed-off-by: Francesco Valla <valla.francesco@gmail.com>
---
 arch/arm/boot/dts/am335x-icev2.dts | 49 ++++++++++++++++++++++++--------------
 1 file changed, 31 insertions(+), 18 deletions(-)

diff --git a/arch/arm/boot/dts/am335x-icev2.dts b/arch/arm/boot/dts/am335x-icev2.dts
index d5547db..8787cb8 100644
--- a/arch/arm/boot/dts/am335x-icev2.dts
+++ b/arch/arm/boot/dts/am335x-icev2.dts
@@ -25,8 +25,8 @@
 	};
 
 	aliases {
-		ethernet0 = &pruss_emac0;
-		ethernet1 = &pruss_emac1;
+		ethernet0 = &cpsw_emac0;
+		ethernet1 = &cpsw_emac1;
 	};
 
 	vbat: fixedregulator@0 {
@@ -49,7 +49,7 @@
 	};
 
 	leds-iio {
-		status = "disabled";
+		status = "okay";
 		compatible = "gpio-leds";
 		led-out0 {
 			label = "out0";
@@ -147,6 +147,7 @@
 
 	/* Dual mac ethernet application node on icss */
 	pruss_eth {
+		status = "disabled";
 		compatible = "ti,am3359-prueth";
 		pruss = <&pruss>;
 		sram = <&ocmcram_nocache>;
@@ -412,25 +413,37 @@
 
 		partition@0 {
 			label = "u-boot-spl";
-			reg = <0x0 0x80000>;
-			read-only;
+			reg = <0x0 0x010000>;
 		};
 
-		partition@1 {
+		partition@10000 {
 			label = "u-boot";
-			reg = <0x80000 0x100000>;
-			read-only;
+			reg = <0x010000 0x060000>;
 		};
 
-		partition@2 {
+		partition@70000 {
 			label = "u-boot-env";
-			reg = <0x180000 0x20000>;
-			read-only;
+			reg = <0x070000 0x010000>;
+		};
+
+		partition@80000 {
+			label = "kernel";
+			reg = <0x080000 0x260000>;
+		};
+
+		partition@2e0000 {
+			label = "dtb";
+			reg = <0x2e0000 0x020000>;
+		};
+
+		partition@300000 {
+			label = "rootfs";
+			reg = <0x300000 0x490000>;
 		};
 
-		partition@3 {
-			label = "misc";
-			reg = <0x1A0000 0x660000>;
+		partition@790000 {
+			label = "aux";
+			reg = <0x790000 0x070000>;
 		};
 	};
 
@@ -559,7 +572,7 @@
 		gpio-hog;
 		gpios = <10 GPIO_ACTIVE_HIGH>;
 		/* ETH1 mux: Low for MII-PRU, high for RMII-CPSW */
-		output-low;
+		output-high;
 		line-name = "MUX_MII_CTL1";
 	};
 };
@@ -569,7 +582,7 @@
 	pinctrl-names = "default";
 	reset-gpios = <&gpio2 5 GPIO_ACTIVE_LOW>;
 	reset-delay-us = <2>; /* PHY datasheet states 1uS min */
-	status = "okay";
+	status = "disabled";
 
 	pruss_eth0_phy: ethernet-phy@1 {
 		 reg = <1>;
@@ -596,7 +609,7 @@
 	pinctrl-names = "default", "sleep";
 	pinctrl-0 = <&cpsw_default>;
 	pinctrl-1 = <&cpsw_sleep>;
-	status = "disabled";
+	status = "okay";
 	dual_emac;
 };
 
@@ -608,7 +621,7 @@
 	pinctrl-names = "default", "sleep";
 	pinctrl-0 = <&davinci_mdio_default>;
 	pinctrl-1 = <&davinci_mdio_sleep>;
-	status = "disabled";
+	status = "okay";
 	reset-gpios = <&gpio2 5 GPIO_ACTIVE_LOW>;
 	reset-delay-us = <2>;   /* PHY datasheet states 1uS min */
 };
-- 
2.7.4

